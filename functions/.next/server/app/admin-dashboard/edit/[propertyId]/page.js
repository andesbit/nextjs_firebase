(()=>{var e={};e.id=517,e.ids=[517],e.modules={326:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,85814,23)),Promise.resolve().then(r.bind(r,5228))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5228:(e,t,r)=>{"use strict";r.d(t,{default:()=>h});var a=r(60687),s=r(37570),i=r(42848);let o=(0,r(62688).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var d=r(6475);let n=(0,d.createServerReference)("7f2565532351b8b47e87b8e972f47ede661bde22fb",d.callServer,void 0,d.findSourceMapURL,"updateProperty");var p=r(16189),l=r(70146),c=r(64204),u=r(52581);function h({id:e,address1:t,address2:r,city:d,postcode:h,bathrooms:m,bedrooms:f,description:b,price:v,status:x,images:y=[]}){let g=(0,p.useRouter)(),_=async t=>{let r=await i.j?.currentUser?.getIdToken();if(!r)return;let{images:a,...s}=t,o=await n({...s,id:e},r);if(o?.error)return void u.oR.error("Error!",{description:o.message});let d=[];y.filter(e=>!a.find(t=>e===t.url)).forEach(e=>{d.push((0,l.XR)((0,l.KR)(i.I,e)))});let p=[];a.forEach((t,r)=>{if(t.file){let a=`properties/${e}/${Date.now()}-${r}-${t.file.name}`;p.push(a);let s=(0,l.KR)(i.I,a);d.push((0,l.bp)(s,t.file))}else p.push(t.url)}),await Promise.all(d),await (0,c.d)({propertyId:e,images:p},r),u.oR.success("Success!",{description:"Property updated"}),g.push("/admin-dashboard")};return(0,a.jsx)("div",{children:(0,a.jsx)(s.A,{handleSubmit:_,submitButtonLabel:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o,{})," Save Property"]}),defaultValues:{address1:t,address2:r,city:d,postcode:h,bathrooms:m,bedrooms:f,description:b,price:v,status:x,images:y.map(e=>({id:e,url:e}))}})})}},7879:e=>{"use strict";e.exports=import("firebase-admin/firestore")},9801:e=>{"use strict";e.exports=import("firebase-admin/app")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14276:e=>{"use strict";e.exports=import("firebase-admin/auth")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26899:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{"7f2565532351b8b47e87b8e972f47ede661bde22fb":()=>i.$,"7f4855f981e6346f4e795faa44be52c93718e0d325":()=>s.e,"7fa15a7309726214326a56027583691615951401c2":()=>s.W,"7fb74a3a61d5e24a7434f6a45b5174db4301be668b":()=>o.d});var s=r(59393),i=r(50688),o=r(7486),d=e([s,i,o]);[s,i,o]=d.then?(await d)():d,a()}catch(e){a(e)}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34298:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>c,pages:()=>l,routeModule:()=>u,tree:()=>p});var a=r(65239),s=r(48088),i=r(88170),o=r.n(i),d=r(30893),n={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);r.d(t,n);let p={children:["",{children:["admin-dashboard",{children:["edit",{children:["[propertyId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,92987)),"/home/adolfo/nextfirebase/src/app/admin-dashboard/edit/[propertyId]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,40186)),"/home/adolfo/nextfirebase/src/app/admin-dashboard/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/adolfo/nextfirebase/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,l=["/home/adolfo/nextfirebase/src/app/admin-dashboard/edit/[propertyId]/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/admin-dashboard/edit/[propertyId]/page",pathname:"/admin-dashboard/edit/[propertyId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:p}})},44790:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{let l,c;r.d(t,{j2:()=>c,kA:()=>l,vx:()=>m});var s=r(7879),i=r(9801),o=r(46675),d=r.n(o),n=r(14276),p=e([s,i,n]);[s,i,n]=p.then?(await p)():p;let u={type:"service_account",project_id:"nextfifo",private_key_id:process.env.FIREBASE_PRIVATE_KEY_ID,private_key:process.env.FIREBASE_PRIVATE_KEY,client_email:process.env.FIREBASE_CLIENT_EMAIL,client_id:process.env.FIREBASE_CLIENT_ID,auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40nextfifo.iam.gserviceaccount.com",universe_domain:"googleapis.com"},h=(0,i.getApps)();if(h.length){let e=h[0];l=(0,s.getFirestore)(e),c=(0,n.getAuth)(e)}else{let e=d().initializeApp({credential:d().credential.cert(u)});l=(0,s.getFirestore)(e),c=(0,n.getAuth)(e)}let m=async(e,t)=>{let r=e.count(),a=(await r.get()).data().count;return Math.ceil(a/t)};a()}catch(e){a(e)}})},46675:e=>{"use strict";e.exports=require("firebase-admin")},50688:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{$:()=>l});var s=r(91199);r(42087);var i=r(89027),o=r(39178),d=r(7944),n=r(33331),p=e([i]);i=(p.then?(await p)():p)[0];let l=async(e,t)=>{let{id:r,...a}=e;if(!(await i.j2.verifyIdToken(t)).admin)return{error:!0,message:"Unauthorized"};let s=o.HW.safeParse(a);if(!s.success)return{error:!0,message:s.error.issues[0]?.message??"An error occurred"};await i.kA.collection("properties").doc(r).update({...a,updated:new Date}),(0,d.revalidatePath)(`/property/${r}`)};(0,n.D)([l]),(0,s.A)(l,"7f2565532351b8b47e87b8e972f47ede661bde22fb",null),a()}catch(e){a(e)}})},60158:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,4536,23)),Promise.resolve().then(r.bind(r,98439))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},92987:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>l});var s=r(37413),i=r(22538),o=r(78963),d=r(99343),n=r(98439),p=e([d]);async function l({params:e}){let t=await e,r=await (0,d.qz)(t.propertyId);return console.log({property:r}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.BI,{items:[{href:"/admin-dashboard",label:"Dashboard"},{label:"Edit Property"}]}),(0,s.jsxs)(o.Zp,{className:"mt-5",children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{className:"text-3xl font-bold",children:"Edit Property"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsx)(n.default,{id:r.id,address1:r.address1,address2:r.address2,city:r.city,postcode:r.postcode,bathrooms:r.bathrooms,bedrooms:r.bedrooms,price:r.price,description:r.description,status:r.status,images:r.images||[]})})]})]})}d=(p.then?(await p)():p)[0],a()}catch(e){a(e)}})},98439:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/adolfo/nextfirebase/src/app/admin-dashboard/edit/[propertyId]/edit-property-form.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/adolfo/nextfirebase/src/app/admin-dashboard/edit/[propertyId]/edit-property-form.tsx","default")},99343:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{Yk:()=>n,oY:()=>o,qz:()=>d});var s=r(44790),i=e([s]);s=(i.then?(await i)():i)[0];let o=async e=>{let t=e?.pagination?.page||1,r=e?.pagination?.pageSize||10,{minPrice:a,maxPrice:i,minBedrooms:o,status:d}=e?.filters||{},n=s.kA.collection("properties").orderBy("updated","desc");null!=a&&(n=n.where("price",">=",a)),null!=i&&(n=n.where("price","<=",i)),null!=o&&(n=n.where("bedrooms",">=",o)),d&&(n=n.where("status","in",d));let p=await (0,s.vx)(n,r);return{data:(await n.limit(r).offset((t-1)*r).get()).docs.map(e=>({id:e.id,...e.data()})),totalPages:p}},d=async e=>{let t=await s.kA.collection("properties").doc(e).get();return{id:t.id,...t.data()}},n=async e=>e.length?(await s.kA.collection("properties").where("__name__","in",e).get()).docs.map(e=>({id:e.id,...e.data()})):[];a()}catch(e){a(e)}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,431,322,511,846,303,59,944,897,604],()=>r(34298));module.exports=a})();